<template name="listing">
    <div class="container" id="wrap">
        {{#if Template.subscriptionsReady}}
            {{#with listing}}
                <div class="card-panel animated fadeIn">
                    <div class="row">
                        {{#if photoIds}}
                            {{> photoCarousel}}
                        {{/if}}
                        <div class="col {{#if photoIds}}m6{{else}}m12{{/if}} s12">
                            {{#if isOwner owner}}
                                <button id="remove-listing" class="btn-flat waves-effect waves-light waves-red darken-3 right">
                                    <i class="material-icons">clear</i>
                                </button>
                                <button id="edit-listing" class="btn-flat waves-effect waves-light waves-green darken-3 right">
                                    <i class="material-icons">edit</i>
                                </button>
                            {{else}}
                                <button id="favorite-listing" class="btn-flat waves-effect waves-light waves-red darken-4 right">
                                    <i class="material-icons">{{#if favorited}}favorite{{else}}favorite_border{{/if}}</i>
                                </button>
                            {{/if}}

                            <h5>{{title}}</h5>
                            <p>{{category}}</p>
                            <p><strong>${{price}}</strong></p>
                            <p>{{city}}, {{state}}</p>
                            <p>{{date}}</p>
                            <div class="section">
                                <label>Description</label>
                                <p>{{description}}</p>
                            </div>

                            <div class="divider"></div>
                            <div class="section">
                                <p><i class="material-icons listing-contact-icons">mail</i>{{email}}</p>
                                {{#if phone}}
                                    <p><i class="material-icons listing-contact-icons">phone</i>{{phone}}</p>
                                {{/if}}
                            </div>
                        </div>
                    </div>
                </div>
            {{/with}}
        {{else}}
            {{> spinner}}
        {{/if}}
    </div>

    {{> removeListingModal}}
    {{> editListing listing}}
</template>

<template name="photoCarousel">
    <div id="photo-carousel" class="col m6 s12">
        {{#each photoIds}}
            <a data-lightbox="photos" href="{{picture this}}">
                <img class="listing-photo" src="{{picture this}}" alt="{{picture.name}}">
            </a>
        {{/each}}
    </div>
</template>